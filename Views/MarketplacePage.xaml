<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Profinder_1._0.Views.MarketplacePage"
             Title="Buscar Profesionales">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <!-- üîô Volver a la p√°gina anterior -->
            <ImageButton Source="back_arrow.png"
                         Clicked="OnBackClicked"
                         BackgroundColor="Transparent"
                         WidthRequest="32"
                         HeightRequest="32"
                         HorizontalOptions="Start"
                         Margin="0,10"
                         Aspect="AspectFit" />

            <!-- üîç Buscador -->
            <SearchBar x:Name="Buscador"
                       Placeholder="Buscar por especialidad..." 
                       TextChanged="OnSearchTextChanged"/>

            <!-- üß≠ Filtro por Especialidad -->
            <Picker x:Name="EspecialidadPicker"
                    Title="Filtrar por especialidad"
                    SelectedIndexChanged="OnEspecialidadSelected">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>Electricista</x:String>
                        <x:String>Plomero</x:String>
                        <x:String>Carpintero</x:String>
                        <x:String>Jardinero</x:String>
                        <x:String>Pintor</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <!-- üåç Filtro por Ciudad -->
            <Picker x:Name="CiudadPicker"
                    Title="Filtrar por ciudad"
                    SelectedIndexChanged="OnCiudadSelected">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>Villa Hayes</x:String>
                        <x:String>Remansito</x:String>
                        <x:String>Benjam√≠n Aceval</x:String>
                        <x:String>Cerrito</x:String>
                        <x:String>Costa</x:String>
                        <x:String>Mariano Roque Alonso</x:String>
                        <x:String>Limpio</x:String>
                        <x:String>Loma Pyt√°</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <!-- üßë‚Äçüîß Listado de profesionales -->
            <CollectionView x:Name="ProjectList">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame BorderColor="LightGray"
                               CornerRadius="10"
                               Padding="15"
                               Margin="5"
                               HasShadow="True">

                            <HorizontalStackLayout Spacing="15">

                                <!-- üñºÔ∏è Foto del profesional -->
                                <Frame WidthRequest="70"
                                       HeightRequest="70"
                                       CornerRadius="35"
                                       Padding="0"
                                       IsClippedToBounds="True"
                                       HasShadow="False"
                                       BackgroundColor="#E0E0E0">
                                    <Image Source="{Binding FotoUrl}"
                                           Aspect="AspectFill"
                                           WidthRequest="70"
                                           HeightRequest="70" />
                                </Frame>

                                <!-- üìã Informaci√≥n del profesional -->
                                <VerticalStackLayout Spacing="2">
                                    <Label Text="{Binding Nombre}" FontSize="18" FontAttributes="Bold" />
                                    <Label Text="{Binding Especialidad}" FontSize="14" TextColor="Gray" />
                                    <Label Text="{Binding Ubicacion}" FontSize="14" TextColor="Gray" />
                                    <Label Text="{Binding Descripcion}" FontSize="13" LineBreakMode="WordWrap" />
                                    <Label Text="{Binding Correo}" FontSize="12" TextColor="#007AFF" />
                                    <Label Text="{Binding Telefono}" FontSize="12" TextColor="#007AFF" />

                                    <Button Text="Ver perfil completo"
                                            FontSize="14"
                                            Clicked="OnViewProfileClicked"
                                            BackgroundColor="#007AFF"
                                            TextColor="White"
                                            CornerRadius="5"
                                            WidthRequest="150" />
                                </VerticalStackLayout>

                            </HorizontalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
